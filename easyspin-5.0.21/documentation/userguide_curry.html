<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <link rel="icon" href="img/eslogo196.png">
   <link rel="stylesheet" type="text/css" href="style.css">
   <link rel="stylesheet" href="highlight/matlab.css">
   <script src="highlight/highlight.pack.js"></script>
   <script>hljs.initHighlightingOnLoad();</script>
   <title>User guide: curry</title>
</head>

<body>

<header>
<ul>
<li><img src="img/eslogo42.png">
<li class="header-title">EasySpin
<li><a href="index.html">Documentation</a>
<li><a href="references.html">Publications</a>
<li><a href="http://easyspin.org" target="_blank">Website</a>
<li><a href="http://easyspin.org/forum" target="_blank">Forum</a>
</ul>
</header>

<section>

<div class="functitle">Calculating magnetic moment and magnetic susceptibility</div>

<p>
EasySpin can calculate magnetic moments and magnetic susceptibilities for arbitrary spin systems. Experimentally, these are obtained using a SQUID magnetometer. This user guide explains how to calculate these quantities.

<p>
The following topics are covered:
<ul>
<li><a href="#calling">Running the calculation</a>
<li><a href="#spins">The spin system</a>
<li><a href="#exp">Experimental parameters</a>
<li><a href="#units">Units</a>
<li><a href="#crystals">Single crystals</a>
<li><a href="#options">Calculation options</a>
<li><a href="#fitting">Least-squares fitting</a>
</ul>

<!-- ============================================================= -->
<div class="subtitle" name="calling">Running the calculation</div>

<p>
To calculate magnetic moments and magnetic susceptibilities, you need to provide information on the sample (spin system) and the fields and temperatures used in the SQUID measurement. With these, you then call the function <a class="esf" href="curry.html">curry</a>. Depending on what quantity you want to calculate, you ask for a different number of outputs from <a class="esf" href="curry.html">curry</a>:

<pre class="matlab">
muz = curry(Sys,Exp);
[muz,chizz] = curry(Sys,Exp);
</pre>

<p>
<code>Sys</code> contains the spin system, and <code>Exp</code> contains the experimental parameters. <code>muz</code> is the z component of the magnetic dipole moment, and <code>chizz</code> is the zz component of the magnetic susceptibility.

<p>
Additionally, you can provide a third input argument, <code>Opt</code> that contains some calculation options. For example,

<pre class="matlab">
muz = curry(Sys,Exp,Opt);
</pre>


<!-- ============================================================= -->
<div class="subtitle" name="#spins">The spin system</div>

<p>
To calculate magnetic moment and magnetic susceptibility, first of all you need to provide the system of spins and the parameters of the associated spin Hamiltonian as a <a href="spinsystem">spin system structure</a>. Here is a simple example of two coupled spins-1/2 with isotropic g factors and strong exchange coupling:

<pre class="matlab">
Sys.S = [1/2 1/2];
Sys.g = [2 2];
Sys.ee = -2*-10*29.98e3;   % MHz
</pre>

<p>
Be mindful that EasySpin's electron-electron coupling term <code>Sys.ee</code> uses the convention H = +J S<sub>1</sub>S<sub>2</sub>. Other conventions are often used in the literature. See <a href="hamiltonian.html#eei">here</a> for details.

<p>
Also, EasySpin expects all couplings in units of MHz. Very often, exchange couplings are given in cm<sup>-1</sup>. To convert cm<sup>-1</sup> to MHz use

<pre class="matlab">
J_cm = 5;              % value in cm^-1
J_MHz = J_cm*29.98e3;  % cm^-1 -> MHz conversion
Sys.ee = J_MHz;        % for H = +J*S1*S2

Sys.ee = 5 * 29.98e3;  % all in one line
</pre>

<p>
As with the rest of EasySpin, there is in principle no limit on the number of spins you can specify or on how they can be coupled. The only limit is the computer memory required to hold the spin Hamiltonian and operator matrices.
</p>

<!-- ============================================================= -->
<div class="subtitle" name="exp">Experimental parameters</div>

<p>
For SQUID magnetometry, you only need two basis experimental settings: the magnetic field values and the temperatures at which you measure the magnetic moment and the magnetic susceptibility.

<p>
Give the temperature in <code>Exp.Temperature</code>, in units of K. You can provide either a single temperature or an array of temperatures.

<pre class="matlab">
Exp.Temperature = 298;    % room temperature
Exp.Temperature = 4:300;  % large temperature range
</pre>

<p>
For the magnetic field, use <code>Exp.Field</code> and provide the field values in units of mT. Again, you can give either a single value, or an array of values. If the experiment is run at zero magnetic field, you can omit <code>Exp.Field</code>. 

<pre class="matlab">
Exp.Field = 3000;       % 3000 mT = 3 T
Exp.Field = 0:10:6000;  % 0 t 6T range
</pre>

<p>
If you give a single value for both the temperature and the field, <a class="esf" href="curry.html">curry</a> calculates single values for the outputs. If you provide a single value for one of the parameters and an array for the other, you get an array of results. For example, providing <code>Exp.Field = 1000;</code> and <code>Exp.Temperature = 4:300</code> will yield curves as a function of temperature. Finally, if you provide arrays for both field and temperature, <a class="esf" href="curry.html">curry</a> returns 2D arrays for the results.


<!-- ============================================================= -->
<div class="subtitle" name="units">Units</div>

<p>
<a class="esf" href="curry.html">curry</a> returns the calculated magnetic moments in what might be called "natural units". The numerical value returned by <a class="esf" href="curry.html">curry</a> can be taken either as the molecular magnetic moment &mu;<sub>z</sub> (magnetic moment per molecule) in units of Bohr magnetons (&mu;<sub>B</sub>), or as the molar magnetic moment &mu;<sub>mol,z</sub> (magnetic moment per mole) in "molar Bohr magnetons" (N<sub>A</sub>&mu;<sub>B</sub>). These two are numerically identical. For example, <code>muz = 0.53</code> means the molecular magnetic moment &mu;<sub>z</sub> is 0.53 &mu;<sub>B</sub> and the molar magnetic moment &mu;<sub>mol,z</sub> is 0.53 N<sub>A</sub>&mu;<sub>B</sub>.

<p>
The SI units for these two magnetic moment quantities are J T<sup>-1</sup> and J T<sup>-1</sup> mol<sup>-1</sup>. To convert from the natural units to the SI units, use EasySpin's functions for the Avogadro number (<a class="esf" href="avogadro.html">avogadro</a>) and the Bohr magneton (<a class="esf" href="bmagn.html">bmagn</a>):

<pre class="matlab">
muz_SI = muz*bmagn;              % molecular magnetic moment, natural units to SI units
muzmol_SI = muz*avogadro*bmagn;  % molar magnetic moment, natural units to SI units
</pre>

<p>
The molar magnetic susceptibility &chi;<sub>zz</sub> is returned in SI units of m<sup>3</sup> mol<sup>-1</sup>. Often, the susceptibility is given in the old CGS units of cm<sup>3</sup> mol<sup>-1</sup>. To convert the SI susceptibility to the corresponding CGS quantity, use
<pre class="matlab">
chizz_cgs = chizz_SI/(4*pi*1e-6);     % unit conversion from SI to CGS units
</pre>


<!-- ============================================================= -->
<div class="subtitle" name="crystals">Single crystals</div>

<p>
<code>curry</code> can also calculate magnetic moment and molar magnetic susceptibility of single crystals. For this, you need to provide three things: (a) the orientation of the crystal in the spectrometer in <code>Exp.CrystalOrientation</code>, (b) the space group of the crystal in <code>Exp.CrystalSymmetry</code>, and (c) the orientation of the molecular frame relative to the crystal frame in <code>Exp.MolFrame</code>. You can omit the latter two, in which case the space group is assumed to be P1, and the molecular frame is assumed to be aligne with the crystal frame.

<p>
For more information on the various frames and how to specify the relative orientations, see <a href="frames.html">here</a>.

<p>
Here are some examples on how to use this.

<pre class="matlab">
Exp.CrystalSymmetry = 'P212121';        % space group symbol

Exp.CrystalOrientation = [0 0 0];       % magnetic field along crystal z axis 
Exp.CrystalOrientation = [0 pi/2 0];    % magnetic field along crystal x axis 
Exp.CrystalOrientation = [pi/2 pi/2 0]; % magnetic field along crystal y axis 
</pre>

<!-- ============================================================= -->
<div class="subtitle" name="options">Calculation options</div>

<p>
Without information about a crystal (<code>Exp.CrystalOrientation</code>, <code>Exp.CrystalSymmetry</code>), <a class="esf" href="curry.html">curry</a> assumes the sample is a powder and performs a powder average. The powder average involves evaluating many orientations of the paramagnetic center with respect to the magnetic field, and then averaging them. To adjust the number of orientations included in the powder average, use <code>Opt.nKnots</code>. The higher the number, the more orientations are included.

<pre class="matlab">
Opt.nKnots = 10;   % 10&deg; increments
Opt.nKnots = 19;   % 5&deg; increments
Opt.nKnots = 31;   % 3&deg; increments
</pre>  

<p>
A sufficient number of orientations is necessary to obtain correct data. If you are not sure whether you have enough orientations, increase <code>Opt.nKnots</code> until the calculated data do not change any more.

<p>
Of course, if the spin Hamiltonian is isotropic, you do not have to run a powder average.
</p>



<!-- ============================================================= -->
<div class="subtitle" name="fitting">Least-squares fitting</div>

<p>
You can use EasySpin's least-squares fitting tool <a class="esf" href="esfit.html">esfit</a> to fit magnetometry data using <a class="esf" href="curry.html">curry</a>.

<p>
However, the order and nature of <a class="esf" href="curry.html">curry</a>'s output arguments is different from the main EasySpin simulation functions <a class="esf" href="pepper.html">pepper</a>, <a class="esf" href="garlic.html">garlic</a>, <a class="esf" href="chili.html">chili</a>, etc. By default, <a class="esf" href="esfit.html">esfit</a> is set up for these latter functions.
To make <a class="esf" href="esfit.html">esfit</a> work for <a class="esf" href="curry.html">curry</a>, you need to provide information about the type of output arguments via the fitting option <code>FitOpt.OutArg</code>.

<p>
<code>FitOpt.OutArg</code> should be an array of two numbers, for example <code>FitOpt.OutArg = [3 2]</code>. The first number indicates how many output arguments <code>esfit</code> should ask for when calling the simulation function. The second number indicates which output argument to use for fitting. So, <code>FitOpt.OutArg = [3 2]</code> indicates to call the simulation function with three outputs, and then use the second to fit to the data.

<p>
For <a class="esf" href="curry.html">curry</a>, you need to use the following settings, depending on what you want to fit. For fitting the magnetic moment, have <a class="esf" href="curry.html">curry</a> be called only with one output and use it:

<pre class="matlab">
FitOpt.OutArg = [1 1];   % to fit the magnetic moment muz (first output)
</pre>

<p>
The magnetic susceptibility &chi;<sub>zz</sub> is the second output argument of <a class="esf" href="curry.html">curry</a>. To fit it, have <a class="esf" href="curry.html">curry</a> be called with 2 outputs and use the second:

<pre class="matlab">
FitOpt.OutArg = [2 2];   % to fit the magnetic susceptibility chizz (second output)
</pre>

<p>
For more details on least-squares fitting, see the corresponding <a href="userguide_fitting.htm;">user guide</a> and the reference page on <a class="esf" href="esfit.html">esfit</a>.

<hr>

</section>


<footer>
</footer>

</body>

</html>
